<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Summary Daily Delivery Order</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <!-- Google Fonts Orbitron -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet" />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Data Labels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <!-- SheetJS -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <style>
        body {
            font-family: 'Orbitron', monospace, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 0;
        }
        /* Sidebar */
        #sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 320px;
            background-color: #fff;
            border-right: 3px solid #3498db;
            padding: 20px;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 1050;
        }
        #sidebar.collapsed {
            transform: translateX(-100%);
        }
        #sidebar h4, #sidebar h5 {
            color: #3498db;
            font-weight: 700;
            margin-bottom: 15px;
        }
        #sidebar .form-label {
            font-weight: 600;
            color: #2c3e50;
        }
        #sidebar .form-select, #sidebar input[type="date"], #sidebar input[type="file"] {
            font-family: 'Orbitron', monospace;
        }
        #sidebar .btn {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
        }
        /* Sidebar toggle button */
        #sidebarToggle {
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1100;
            background-color: #3498db;
            border: none;
            color: white;
            padding: 10px 14px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.7);
            transition: background-color 0.3s ease;
        }
        #sidebarToggle:hover {
            background-color: #2980b9;
        }
        /* Main content */
        #mainContent {
            margin-left: 340px;
            padding: 20px;
            transition: margin-left 0.3s ease;
        }
        #mainContent.expanded {
            margin-left: 20px;
        }
        /* Select All label */
        .select-all-option {
            font-weight: 700;
            color: #e74c3c;
            cursor: pointer;
        }
        /* KPI cards */
        .kpi-card {
            font-family: 'Orbitron', monospace;
            background-color: #ffffff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.15);
            margin-bottom: 20px;
            text-align: center;
            color: #2c3e50;
        }
        .kpi-value {
            font-size: 28px;
            font-weight: 900;
            color: #3498db;
        }
        .kpi-label {
            font-size: 16px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        /* Chart titles */
        .chart-title {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 15px;
            color: #3498db;
        }
        /* Tab nav */
        .nav-tabs .nav-link {
            color: #3498db;
            font-weight: 600;
            font-family: 'Orbitron', monospace;
        }
        .nav-tabs .nav-link.active {
            color: #e74c3c;
            font-weight: 700;
            border-bottom: 3px solid #e74c3c;
        }
        /* Chart container */
        .chart-container {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        /* Icon box */
        .icon-box {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
        }
        /* Footer */
        .footer {
            background-color: #2c3e50;
            color: white;
            padding: 10px 0;
            text-align: center;
            margin-top: 30px;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Sidebar Toggle Button -->
    <button id="sidebarToggle" aria-label="Toggle Sidebar"><i class="fas fa-bars"></i></button>

    <!-- Sidebar -->
    <aside id="sidebar" role="complementary" aria-label="Sidebar with Upload and Filters">
        <!-- Upload Section -->
        <section class="upload-area mb-4" aria-label="Upload Excel File Section">
            <h4><i class="fas fa-file-upload"></i> Upload File Excel</h4>
            <p>File harus berformat Excel (.xlsx) dengan ukuran 2MB - 30MB</p>
            <input type="file" id="file-upload" class="form-control" accept=".xlsx, .xls" aria-describedby="uploadHelp" aria-label="Upload Excel file" />
            <small id="uploadHelp" class="form-text text-muted">
                Pastikan file Excel memiliki kolom: Area, DP Date, DP No, Plant Name, QTY, Truck No, Sales Man, Distance, End Customer Name
            </small>
        </section>

        <!-- Filter Section -->
        <section class="filter-section" aria-label="Filter Data Section">
            <h5><i class="fas fa-filter"></i> Filter Data</h5>
            <form id="filterForm" aria-label="Filter delivery data">
                <div class="mb-3">
                    <label for="area-filter" class="form-label">Area</label>
                    <select class="form-select" id="area-filter" multiple aria-multiselectable="true" aria-label="Filter by Area"></select>
                    <div class="form-check mt-1">
                        <input class="form-check-input" type="checkbox" id="selectAllArea" aria-label="Select all Area" />
                        <label class="form-check-label select-all-option" for="selectAllArea">Select All</label>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="start-date" class="form-label">Start Date</label>
                    <input type="date" class="form-control" id="start-date" aria-label="Start date filter" />
                </div>
                <div class="mb-3">
                    <label for="end-date" class="form-label">End Date</label>
                    <input type="date" class="form-control" id="end-date" aria-label="End date filter" />
                </div>
                <div class="mb-3">
                    <label for="plant-filter" class="form-label">Plant Name</label>
                    <select class="form-select" id="plant-filter" multiple aria-multiselectable="true" aria-label="Filter by Plant Name"></select>
                    <div class="form-check mt-1">
                        <input class="form-check-input" type="checkbox" id="selectAllPlant" aria-label="Select all Plant Name" />
                        <label class="form-check-label select-all-option" for="selectAllPlant">Select All</label>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="salesman-filter" class="form-label">Sales Man</label>
                    <select class="form-select" id="salesman-filter" multiple aria-multiselectable="true" aria-label="Filter by Sales Man"></select>
                    <div class="form-check mt-1">
                        <input class="form-check-input" type="checkbox" id="selectAllSalesman" aria-label="Select all Sales Man" />
                        <label class="form-check-label select-all-option" for="selectAllSalesman">Select All</label>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="customer-filter" class="form-label">End Customer Name</label>
                    <select class="form-select" id="customer-filter" multiple aria-multiselectable="true" aria-label="Filter by End Customer Name"></select>
                    <div class="form-check mt-1">
                        <input class="form-check-input" type="checkbox" id="selectAllCustomer" aria-label="Select all End Customer Name" />
                        <label class="form-check-label select-all-option" for="selectAllCustomer">Select All</label>
                    </div>
                </div>
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-primary flex-grow-1" id="apply-filters">Terapkan Filter</button>
                    <button type="button" class="btn btn-secondary flex-grow-1" id="reset-filters">Reset Filter</button>
                </div>
            </form>
        </section>
    </aside>

    <!-- Main Content -->
    <main id="mainContent" role="main" tabindex="-1">
        <header class="header mb-4">
            <div class="container-fluid px-0">
                <h1 class="text-center" style="font-family: 'Orbitron', monospace; font-weight: 900; color: #3498db;">
                    Summary Daily Delivery Order
                </h1>
                <p class="text-center" id="last-update" style="font-family: 'Orbitron', monospace; font-weight: 600; color: #7f8c8d;">
                    Last Update: -
                </p>
            </div>
        </header>

        <!-- KPI Section -->
        <section class="row mb-4" aria-label="Key Performance Indicators">
            <div class="col-md-2 col-sm-6">
                <div class="kpi-card">
                    <div class="kpi-value" id="total-area">0</div>
                    <div class="kpi-label">Total Area</div>
                </div>
            </div>
            <div class="col-md-2 col-sm-6">
                <div class="kpi-card">
                    <div class="kpi-value" id="total-plant">0</div>
                    <div class="kpi-label">Total Plant</div>
                </div>
            </div>
            <div class="col-md-2 col-sm-6">
                <div class="kpi-card">
                    <div class="kpi-value" id="total-volume">0</div>
                    <div class="kpi-label">Total Volume</div>
                </div>
            </div>
            <div class="col-md-2 col-sm-6">
                <div class="kpi-card">
                    <div class="kpi-value" id="avg-volume">0</div>
                    <div class="kpi-label">Avg Volume Per Plant</div>
                </div>
            </div>
            <div class="col-md-2 col-sm-6">
                <div class="kpi-card">
                    <div class="kpi-value" id="total-tm">0</div>
                    <div class="kpi-label">Total TM</div>
                </div>
            </div>
            <div class="col-md-2 col-sm-6">
                <div class="kpi-card">
                    <div class="kpi-value" id="avg-load-trip">0</div>
                    <div class="kpi-label">Avg Load/Trip</div>
                </div>
            </div>
        </section>

        <!-- Tab Navigation -->
        <ul class="nav nav-tabs mb-4" id="dashboardTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="logistic-tab" data-bs-toggle="tab" data-bs-target="#logistic" type="button" role="tab" aria-controls="logistic" aria-selected="true">
                    <i class="fas fa-truck"></i> Logistic
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="sales-tab" data-bs-toggle="tab" data-bs-target="#sales" type="button" role="tab" aria-controls="sales" aria-selected="false">
                    <i class="fas fa-chart-line"></i> Sales And End Customer Performance
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="dashboardTabContent">
            <!-- Logistic Tab -->
            <section class="tab-pane fade show active" id="logistic" role="tabpanel" aria-labelledby="logistic-tab">
                <div class="row mb-4">
                    <div class="col-12">
                        <h4><span class="icon-box"><i class="fas fa-chart-pie"></i></span> Delivery Performance</h4>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Total Volume Delivery Per Area</div>
                            <canvas id="volume-per-area-chart" aria-label="Pie chart of total volume delivery per area" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Total Volume Delivery Per Plant Name</div>
                            <canvas id="volume-per-plant-chart" aria-label="Bar chart of total volume delivery per plant name" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Avg Volume Delivery Per Area</div>
                            <canvas id="avg-volume-area-chart" aria-label="Bar chart of average volume delivery per area" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Avg Volume Delivery Per Plant Name</div>
                            <canvas id="avg-volume-plant-chart" aria-label="Bar chart of average volume delivery per plant name" role="img"></canvas>
                        </div>
                    </div>
                </div>

                <div class="row mb-4 mt-4">
                    <div class="col-12">
                        <h4><span class="icon-box"><i class="fas fa-truck-loading"></i></span> Truck Utilization</h4>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Total Volume Delivery Per Truck No</div>
                            <canvas id="volume-per-truck-chart" aria-label="Bar chart of total volume delivery per truck number" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Total Trip per Truck No</div>
                            <canvas id="trip-per-truck-chart" aria-label="Bar chart of total trips per truck number" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Avg Load per Trip per Truck No</div>
                            <canvas id="avg-load-truck-chart" aria-label="Bar chart of average load per trip per truck number" role="img"></canvas>
                        </div>
                    </div>
                </div>

                <div class="row mb-4 mt-4">
                    <div class="col-12">
                        <h4><span class="icon-box"><i class="fas fa-route"></i></span> Distance</h4>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Avg Distance Per Area</div>
                            <canvas id="avg-distance-area-chart" aria-label="Bar chart of average distance per area" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Avg Distance Per Plant Name</div>
                            <canvas id="avg-distance-plant-chart" aria-label="Bar chart of average distance per plant
